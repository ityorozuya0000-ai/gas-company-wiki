# Setup Instructions

このプロジェクトは Google Apps Script (GAS) で動作します。
以下の手順で環境を準備してください。

## 1. Google スプレッドシートの作成
1.  ブラウザで [sheet.new](https://sheet.new) にアクセスし、新しいスプレッドシートを作成します。
2.  名前を `GAS Company Wiki DB` (任意) に変更します。
3.  シート名（タブ名）を `Pages` に変更します。
4.  **スプレッドシートID** (URLの `d/` から `/edit` の間の文字列) をコピーしておきます。
    *   ※ ヘッダー行は後ほどのステップでGASを使って自動生成します。

## 2. 画像・動画保存用フォルダの作成
1.  Googleドライブで新しいフォルダを作成します。
2.  名前を `Wiki_Assets` (任意) にします。
3.  **フォルダID** (URLの `folders/` 以下の文字列) をコピーしておきます。
4.  **重要**: 社内全員が見れるように、このフォルダの共有設定を「リンクを知っている全員（閲覧可）」または「ドメイン内の全員（閲覧可）」に設定してください。

## 3. GASプロジェクトへのコード反映
GASエディタ（スクリプトエディタ）を開き、以下のファイルを作成して、配布されたコードをそれぞれコピー＆ペーストしてください。

### 3-1. マニフェストファイル (appsscript.json)
1.  左側メニューの「プロジェクトの設定（歯車アイコン）」を開きます。
2.  「「appsscript.json」マニフェスト ファイルをエディタで表示する」にチェックを入れます。
3.  エディタ画面に戻り、`appsscript.json` を開き、コードを上書きします。

### 3-2. スクリプトファイル (.gs)
以下のファイルを作成し、それぞれのコードを貼り付けます。
*   `Code.gs`: バックエンドロジック
*   `Config.gs`: 設定ファイル

### 3-3. HTMLファイル (.html)
「ファイルを追加 (+)」から「HTML」を選択し、以下のファイルを作成してコードを貼り付けます。
*   `index.html`: メイン画面
*   `css.html`: スタイル定義
*   `js.html`: JavaScriptロジック
*   `setup.html`: セットアップ画面

## 4. デプロイと初期設定
1.  GASエディタの画面右上にある **「デプロイ」 > 「新しいデプロイ」** をクリックします。
2.  「ウェブアプリ」を選択し、以下を設定して「デプロイ」します。
    *   **次のユーザーとして実行**: **自分**
    *   **アクセスできるユーザー**: **ドメイン内の全員** (またはGoogleアカウントを持つ全員)
3.  発行された **ウェブアプリのURL** にアクセスします。
4.  **セットアップ画面** が表示されるので、STEP 1, 2 で取得したID (またはURL) を入力して「Save & Initialize」ボタンを押してください。
5.  自動的に初期設定が完了し、Wikiのトップ画面に移動します。